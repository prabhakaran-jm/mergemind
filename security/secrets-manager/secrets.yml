# Secrets management configuration for MergeMind
# This file defines the structure and metadata for secrets

secrets:
  # GitLab Configuration
  gitlab-token:
    description: "GitLab API token for accessing merge requests and project data"
    type: "api-token"
    rotation_schedule: "90d"
    access_level: "read-write"
    environments: ["production", "staging", "development"]
    tags: ["gitlab", "api", "external"]
    
  gitlab-webhook-secret:
    description: "GitLab webhook secret for validating incoming webhooks"
    type: "webhook-secret"
    rotation_schedule: "180d"
    access_level: "read-only"
    environments: ["production", "staging"]
    tags: ["gitlab", "webhook", "security"]

  # Slack Configuration
  slack-signing-secret:
    description: "Slack signing secret for validating Slack requests"
    type: "webhook-secret"
    rotation_schedule: "180d"
    access_level: "read-only"
    environments: ["production", "staging"]
    tags: ["slack", "webhook", "security"]
    
  slack-bot-token:
    description: "Slack bot token for sending messages and interacting with users"
    type: "bot-token"
    rotation_schedule: "90d"
    access_level: "read-write"
    environments: ["production", "staging"]
    tags: ["slack", "bot", "external"]

  # Google Cloud Configuration
  gcp-service-account-key:
    description: "Google Cloud service account key for BigQuery and Vertex AI access"
    type: "service-account-key"
    rotation_schedule: "365d"
    access_level: "read-write"
    environments: ["production", "staging", "development"]
    tags: ["gcp", "bigquery", "vertex-ai", "credentials"]

  # Database Configuration
  database-url:
    description: "Database connection string for application database"
    type: "connection-string"
    rotation_schedule: "90d"
    access_level: "read-write"
    environments: ["production", "staging"]
    tags: ["database", "connection", "internal"]

  # API Configuration
  api-secret-key:
    description: "Secret key for API authentication and session management"
    type: "secret-key"
    rotation_schedule: "30d"
    access_level: "read-write"
    environments: ["production", "staging", "development"]
    tags: ["api", "authentication", "security"]

  jwt-secret-key:
    description: "JWT secret key for token signing and verification"
    type: "jwt-secret"
    rotation_schedule: "30d"
    access_level: "read-write"
    environments: ["production", "staging", "development"]
    tags: ["jwt", "authentication", "security"]

  # Encryption Configuration
  encryption-key:
    description: "Encryption key for sensitive data at rest"
    type: "encryption-key"
    rotation_schedule: "90d"
    access_level: "read-write"
    environments: ["production", "staging"]
    tags: ["encryption", "security", "data-protection"]

  # Monitoring Configuration
  prometheus-basic-auth:
    description: "Basic authentication credentials for Prometheus"
    type: "basic-auth"
    rotation_schedule: "90d"
    access_level: "read-only"
    environments: ["production", "staging"]
    tags: ["monitoring", "prometheus", "authentication"]

  grafana-admin-password:
    description: "Grafana admin password for dashboard access"
    type: "admin-password"
    rotation_schedule: "90d"
    access_level: "read-write"
    environments: ["production", "staging"]
    tags: ["monitoring", "grafana", "admin"]

  # External Service Configuration
  sentry-dsn:
    description: "Sentry DSN for error tracking and monitoring"
    type: "dsn"
    rotation_schedule: "180d"
    access_level: "read-write"
    environments: ["production", "staging"]
    tags: ["monitoring", "sentry", "external"]

  # Development Configuration
  dev-api-key:
    description: "Development API key for testing and development"
    type: "api-key"
    rotation_schedule: "30d"
    access_level: "read-write"
    environments: ["development"]
    tags: ["development", "api", "testing"]

# Secret rotation policies
rotation_policies:
  high-frequency:
    schedule: "30d"
    secrets: ["api-secret-key", "jwt-secret-key", "dev-api-key"]
    
  medium-frequency:
    schedule: "90d"
    secrets: ["gitlab-token", "slack-bot-token", "database-url", "encryption-key"]
    
  low-frequency:
    schedule: "180d"
    secrets: ["gitlab-webhook-secret", "slack-signing-secret", "sentry-dsn"]
    
  annual:
    schedule: "365d"
    secrets: ["gcp-service-account-key"]

# Access control policies
access_policies:
  production:
    allowed_users: ["devops-team", "engineering-manager"]
    required_approval: true
    audit_logging: true
    
  staging:
    allowed_users: ["devops-team", "engineering-team"]
    required_approval: false
    audit_logging: true
    
  development:
    allowed_users: ["engineering-team", "qa-team"]
    required_approval: false
    audit_logging: false

# Compliance requirements
compliance:
  gdpr:
    data_classification: "personal"
    retention_period: "7y"
    encryption_required: true
    
  soc2:
    audit_logging: true
    access_control: true
    encryption_required: true
    
  pci:
    data_classification: "sensitive"
    encryption_required: true
    access_control: true
